SML.di("./DSWSCRFk.js",import.meta.url,"DSWSCRFk");SML.di("./DAgRafdt.js",import.meta.url,"DAgRafdt");SML.di("./OAEZpqSu.js",import.meta.url,"OAEZpqSu");SML.di("./C-AymPzu.js",import.meta.url,"C-AymPzu");SML.di("./BQbyLE0C.js",import.meta.url,"BQbyLE0C");SML.di("./B_Z23SiP.js",import.meta.url,"B_Z23SiP");SML.di("./ANc6hYHB.js",import.meta.url,"ANc6hYHB");SML.di("./BHN2zcRJ.js",import.meta.url,"BHN2zcRJ");SML.di("./DjoKwtwQ.js",import.meta.url,"DjoKwtwQ");SML.di("./BY0sdjRu.js",import.meta.url,"BY0sdjRu");SML.di("./C9Y39_ZO.js",import.meta.url,"C9Y39_ZO");SML.di("./zYHiKPTa.js",import.meta.url,"zYHiKPTa");SML.di("./CSE2B15f.js",import.meta.url,"CSE2B15f");SML.di("./BP7JtdRP.js",import.meta.url,"BP7JtdRP");SML.di("./Dj1DJbmt.js",import.meta.url,"Dj1DJbmt");SML.di("./BVLgyhDE.js",import.meta.url,"BVLgyhDE");SML.di("./Vy1IDB19.js",import.meta.url,"Vy1IDB19");SML.di("./B8bCssFV.js",import.meta.url,"B8bCssFV");SML.di("./em8GmEry.js",import.meta.url,"em8GmEry");SML.di("./mLeBs957.js",import.meta.url,"mLeBs957");SML.di("./DdIwQUSk.js",import.meta.url,"DdIwQUSk");SML.di("./s1sP3jLz.js",import.meta.url,"s1sP3jLz");SML.di("./DvsbXjsy.js",import.meta.url,"DvsbXjsy");SML.di("./alLlRaWG.js",import.meta.url,"alLlRaWG");SML.di("./DxvZ7Xss.js",import.meta.url,"DxvZ7Xss");SML.di("./Dnwr24bF.js",import.meta.url,"Dnwr24bF");SML.di("./DOyzSNfA.js",import.meta.url,"DOyzSNfA");SML.di("./BjRhnMPP.js",import.meta.url,"BjRhnMPP");
SML.dm("C3p34GtE",["DSWSCRFk","DAgRafdt","OAEZpqSu","C-AymPzu","BQbyLE0C","B_Z23SiP","ANc6hYHB","BHN2zcRJ","DjoKwtwQ","C9Y39_ZO","BVLgyhDE","Vy1IDB19","B8bCssFV","DdIwQUSk","BY0sdjRu","zYHiKPTa","CSE2B15f","BP7JtdRP","Dj1DJbmt","em8GmEry","mLeBs957","s1sP3jLz","DvsbXjsy","alLlRaWG","DxvZ7Xss","Dnwr24bF","DOyzSNfA","BjRhnMPP"],(async(e,a,t,i,n,o,s,r,l,d,m,u,c,p)=>{const h="dont-notify-tooltip-close",g="removal-reason-input-changed",{svg:v}=e.g(),I=e.w(v`<path d="M15.11 8.7l-1.63-.34c-.93-.19-1.65-.91-1.84-1.84l-.34-1.63c-.23-1.12-1.16-1.87-2.3-1.87s-2.07.75-2.3 1.87l-.34 1.63c-.19.93-.92 1.65-1.84 1.84l-1.63.34c-1.12.23-1.87 1.16-1.87 2.3s.75 2.07 1.87 2.3l1.63.34c.93.19 1.65.91 1.84 1.84l.34 1.63c.23 1.12 1.16 1.87 2.3 1.87s2.07-.75 2.3-1.87l.34-1.63c.19-.93.92-1.65 1.84-1.84l1.63-.34c1.12-.23 1.87-1.16 1.87-2.3s-.75-2.07-1.87-2.3zm-.37 2.84l-1.63.34c-1.63.34-2.9 1.61-3.24 3.24l-.34 1.63c-.08.4-.4.44-.54.44s-.46-.04-.54-.44l-.34-1.63a4.178 4.178 0 00-3.24-3.24l-1.63-.34c-.39-.08-.44-.4-.44-.54s.04-.46.44-.54l1.63-.34c1.63-.34 2.9-1.61 3.24-3.24l.34-1.63c.08-.4.4-.44.54-.44s.46.04.54.44l.34 1.63c.34 1.63 1.61 2.9 3.24 3.24l1.63.34c.39.08.44.4.44.54s-.04.46-.44.54zM18 3.1h-1.1V2c0-.5-.4-.9-.9-.9s-.9.4-.9.9v1.1H14c-.5 0-.9.4-.9.9s.4.9.9.9h1.1V6c0 .5.4.9.9.9s.9-.4.9-.9V4.9H18c.5 0 .9-.4.9-.9s-.4-.9-.9-.9z"></path>`,"0 0 20 20","ai");class N extends CustomEvent{constructor(e){super(N.eventName,{detail:e,bubbles:!0,composed:!0})}}N.eventName="select-suggested-removal-reason";let R=class extends e.s{constructor(){super(...arguments),this.reasons=[],this.suggestions=[],this.eventContext={}}getReasonNumber(e){const a=this.reasons.findIndex((a=>a.id===e));return a>=0?a+1:0}getSelectedChip(){return this.shadowRoot?.querySelector('rpl-filter-chip[name="removal-reason-suggestion"][selected]')??null}render(){return e.x` <div class="my-xs w-fit"> ${I({size:e.I.ExtraSmall})} ${"Suggested"} <rpl-tooltip appearance="inverted" trigger="hover focus" placement="right" @click="${e=>e.preventDefault()}"> ${e.bS({size:e.I.ExtraSmall})} <span slot="content" class="pointer-events-auto"> ${"Suggestions based on the content, your rules, and your removal reasons."} <a href="https://support.reddithelp.com/hc/articles/15484471320980-Saved-Responses" target="_blank" class="text-inverted-neutral-content-strong" @click="${e=>e.stopPropagation()}"> ${"Learn more"} </a> </span> </rpl-tooltip> <div class="flex flex-col gap-xs mt-xs"> ${this.suggestions.map((a=>{const t=this.getReasonNumber(a.id);return e.x` <faceplate-tracker source="moderator" action="click" noun="removal_reason_recommendation" data-faceplate-tracking-context="${JSON.stringify({action_info:{reason:a.id},subreddit:{id:this.eventContext.subredditId},post:{id:this.eventContext.postId},comment:{id:this.eventContext.commentId}})}" @click="${e=>{e.preventDefault(),e.stopPropagation()}}"> <rpl-filter-chip name="removal-reason-suggestion" class="max-w-fit" appearance="bordered" data-removal-reason-id="${a.id}" ?selected="${this.value===a.id}" @click="${()=>{this.dispatchEvent(new N({reasonId:a.id}))}}">${t?`${t}. `:""}${a.title}</rpl-filter-chip> </faceplate-tracker> `}))} </div> </div> `;}};R.styles=[a.t],e._([e.n({type:Array})],R.prototype,"reasons",void 0),e._([e.n({type:Array})],R.prototype,"suggestions",void 0),e._([e.n({type:Object,attribute:"event-context"})],R.prototype,"eventContext",void 0),e._([e.n()],R.prototype,"value",void 0),R=e._([e.c("removal-reason-suggestions")],R);let k=class extends e.s{constructor(){super(...arguments),this._showCoachmark=!localStorage.getItem(this.getLocalStorageKey()),this.closeCoachmark=e=>{e.stopPropagation(),this._showCoachmark=!1},this.handleLearnMore=e=>{e.stopPropagation(),window.open("https://support.reddithelp.com/hc/articles/15484471320980-Saved-Responses","_blank")}}getLocalStorageKey(){return a.N.RemovalReasonSuggestionsCoachmarkSeen}connectedCallback(){super.connectedCallback();localStorage.getItem(this.getLocalStorageKey())?this._showCoachmark=!1:(localStorage.setItem(this.getLocalStorageKey(),"true"),this._showCoachmark=!0)}disconnectedCallback(){super.disconnectedCallback()}render(){return e.x`<rpl-coachmark placement="${m.P.Bottom}" appearance="${u.a.Inverted}" ?open="${this._showCoachmark}" class="w-[270px]"> <slot></slot> <rpl-coachmark-card slot="content" aria-live="polite" appearance="${u.a.Inverted}" class="w-[270px]"> <div slot="title" class="pt-xs pb-2xs"> <div> ${"Save time with suggested removal reasons"} </div> </div> ${a.J({attributes:{className:"close-btn",slot:"close-button",onclick:e=>{e.stopPropagation(),this.closeCoachmark(e)}},appearance:"plainInverted",size:a.a2.Small,leadingIcon:e.m({size:e.I.Small})})} <div class="text-12 mb-sm"> ${"Based on the content, your rules, and your removal reasons, weâ€™ll suggest the most likely removal reasons."} </div> ${a.J({attributes:{slot:"secondary-button",onclick:this.handleLearnMore},children:"Learn More",appearance:"plainInverted",size:a.a2.Small})} ${a.J({attributes:{slot:"primary-button",onclick:this.closeCoachmark},children:"Got It",appearance:"plainInverted",size:a.a2.Small})} </rpl-coachmark-card> </rpl-coachmark>`;}};k.styles=[a.t],e._([e.b()],k.prototype,"_showCoachmark",void 0),k=e._([e.c("removal-reason-suggestions-coachmark")],k);class b extends c.F{constructor(){super(...arguments),this.isInputDirty=!1,this.hasInvalidMacro=!1,this.required=!1,this.handleSubmit=()=>{this.isInputDirty=!0},this.handleInvalid=e=>{e.preventDefault()}}get value(){const e=this._internals.getFormValue();return e?e.toString():null}set value(e){e!==this.value&&(this._internals.setFormValue(e),this.updateValidity(),this.dispatchEvent(new CustomEvent(g,{detail:{value:e},bubbles:!0})))}connectedCallback(){super.connectedCallback(),o.c(this).then((e=>{e?.addEventListener("faceplate-submit",this.handleSubmit)})),this.addEventListener("invalid",this.handleInvalid),this.updateValidity()}disconnectedCallback(){super.disconnectedCallback(),this.form?.removeEventListener("faceplate-submit",this.handleSubmit),this.removeEventListener("invalid",this.handleInvalid)}updateValidity(){this.hasInvalidMacro?this._internals.setValidity({valueMissing:!0},this.getInvalidMacroValidationMessage()):this.required&&!this.value?this._internals.setValidity({valueMissing:!0},this.getValueMissingValidationMessage()):this._internals.setValidity(),this.requestUpdate()}getValueMissingValidationMessage(){return""}getInvalidMacroValidationMessage(){return""}renderValidationState(){return this.isInputDirty&&this.validationMessage?e.x`<span class="text-12 text-danger-content px-md">${this.validationMessage}</span>`:null}}e._([e.b()],b.prototype,"isInputDirty",void 0),e._([e.b()],b.prototype,"hasInvalidMacro",void 0),e._([e.n({type:Boolean})],b.prototype,"required",void 0);class f extends CustomEvent{constructor(e){super(f.eventName,{detail:e,bubbles:!0,composed:!0})}}f.eventName="select-removal-reason";let T=class extends b{constructor(){super(...arguments),this.isSitewide=!1,this.selectedRemovalReason=this.value,this.handleSelectSuggestedRemovalReason=e=>{this.selectReasonById(e.detail.reasonId,!1)},this.handleSelect=e=>{const a=e.target;this.selectReasonById(a.value)}}get displayText(){return this.reasons?.find((e=>e.id===this.value))?.title||""}static get styles(){return[a.t,e.i`:host{display:flex;flex-direction:column}`]}getValueMissingValidationMessage(){return "Removal reason is required.";}getInvalidMacroValidationMessage(){return "This removal reason contains an invalid macro. Please update the removal reason and try again.";}getPlatformRuleOption(){return {id:"default-removal-reason",title:"Breaking platform rules",message:""};}selectReasonById(e,a=!0){const t=(this.includePlatformRuleOption?[...(this.reasons || []),this.getPlatformRuleOption()]:this.reasons||[]).find((a=>a.id===e));t&&this.selectedRemovalReason!==t.id&&(this.selectedRemovalReason=t.id,this.value=t.id,this.dispatchEvent(new f({...t,isSitewide:this.isSitewide,trackEvent:a})))}getDropdownPlaceholder(){return this.isSitewide?"Select a platform rule":"Select a removal reason";}setInvalidMacro(e){this.hasInvalidMacro=e,this.isInputDirty=!0,this.updateValidity()}connectedCallback(){super.connectedCallback(),this.addEventListener(N.eventName,this.handleSelectSuggestedRemovalReason)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(N.eventName,this.handleSelectSuggestedRemovalReason)}render(){return e.x` <label class="text-16 text-neutral-content-strong"> ${super.render()} </label> <faceplate-select-text-input label="${this.getDropdownPlaceholder()}" value="${this.selectedRemovalReason}" readonly="readonly" style="--faceplate-select-menu-max-height:350px;-faceplate-select-menu-max-width:80vw" @faceplate-select-text-input:change="${this.handleSelect}"> ${this.reasons?.map(((a,t)=>e.x`<faceplate-option value="${a.id}" display-text="${a.title}" ?selected="${a.id===this.selectedRemovalReason}"><span slot="leading" class="whitespace-nowrap text-16">${t+1}</span></faceplate-option>`))} ${this.includePlatformRuleOption&&e.x`<faceplate-option value="default-removal-reason" display-text="${this.getPlatformRuleOption().title}"></faceplate-option>`} ${this.includeAddRemovalReasonOption&&e.x`<faceplate-option value="add-removal-reason"> <slot name="link"></slot> </faceplate-option>`} </faceplate-select-text-input> ${this.renderValidationState()} ${this.removalReasonSuggestionsContext?.predictedRemovalSavedResponses&&this.removalReasonSuggestionsContext?.predictedRemovalSavedResponses.length>0?e.x` <removal-reason-suggestions-coachmark> <removal-reason-suggestions class="block w-fit" reasons="${JSON.stringify(this.reasons)}" suggestions="${JSON.stringify(this.removalReasonSuggestionsContext.predictedRemovalSavedResponses)}" event-context="${JSON.stringify(this.removalReasonSuggestionsContext.eventContext)}" value="${this.selectedRemovalReason}"></removal-reason-suggestions> </removal-reason-suggestions-coachmark> `:""} `}};e._([e.n({type:Array})],T.prototype,"reasons",void 0),e._([e.n({type:Boolean,attribute:"is-sitewide"})],T.prototype,"isSitewide",void 0),e._([e.n({type:Boolean,attribute:"include-platform-rule-option"})],T.prototype,"includePlatformRuleOption",void 0),e._([e.n({type:Boolean,attribute:"include-add-removal-reason-option"})],T.prototype,"includeAddRemovalReasonOption",void 0),e._([e.n({type:Object,attribute:"removal-reason-suggestions-context"})],T.prototype,"removalReasonSuggestionsContext",void 0),e._([e.b()],T.prototype,"selectedRemovalReason",void 0),T=e._([e.c("removal-reason-input")],T);let E=class extends d.R{constructor(){super(),this.tooltipVisible=!1,this.trigger="manual",this.placement="top",this.appearance="neutral"}connectedCallback(){super.connectedCallback(),this.initializeTooltip(),this.addEventListener(h,this.hideTooltip)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(h,this.hideTooltip)}async initializeTooltip(){a.K.getItem(a.N.RemovalReasonDontNotifyDismissed)||setTimeout((()=>this.showTooltip()),750)}showTooltip(){this.show()}hideTooltip(e){e.stopPropagation(),a.K.setItem(a.N.RemovalReasonDontNotifyDismissed,"true"),this.hide()}};e._([e.b()],E.prototype,"tooltipVisible",void 0),E=e._([e.c("dont-notify-tooltip")],E);let S=class extends e.s{constructor(){super(...arguments),this.isAIModEnabledForSubreddit=!1}handleClose(){this.dispatchEvent(new CustomEvent(h,{bubbles:!0}))}render(){return e.x` <div class="pointer-events-auto py-xs pl-xs w-[200px]"> <div class="flex flex-row"> <div> <div class="text-14 font-bold text-neutral-content-strong"> ${"Don't want to notify?"} </div> <div class="text-12 font-normal text-neutral-content-strong"> ${this.isAIModEnabledForSubreddit?"Use removal reasons to train automations and track mod actions without notifying users.":"Use removal reasons to track mod actions without notifying users."} </div> </div> ${a.J({appearance:"secondary",leadingIcon:e.m({size:e.I.Small}),size:a.a2.Small,screenReaderContent:"Close tooltip",attributes:{type:"button",className:"flex-shrink-0 -mt-xs",onclick:this.handleClose}})} </div> <div class="flex justify-end mt-md"> ${a.J({appearance:"plain",size:a.a2.Small,children:"Okay",attributes:{type:"button",onclick:this.handleClose}})} </div> </div> `;}};var y;S.styles=[a.t],e._([e.n({type:Boolean,attribute:"is-ai-mod-enabled-for-subreddit"})],S.prototype,"isAIModEnabledForSubreddit",void 0),S=e._([e.c("dont-notify-tooltip-content")],S),function(e){e.Comment="Comment",e.Modmail="Modmail",e.DontNotify="DontNotify"}(y||(y={}));let z=class extends b{constructor(){super(...arguments),this.isModmailAllowed=!1,this.isAIModEnabledForSubreddit=!1}static get styles(){return[a.t,e.i`:host{display:flex;flex-direction:column;gap:var(--spacer-xs)}`]}connectedCallback(){super.connectedCallback(),this.value=y.Comment}getValueMissingValidationMessage(){return "Please select the notification method.";}render(){return e.x` <label class="text-16 text-neutral-content-strong"> ${this._internals.input} ${"Notify user via"} </label> <div class="flex flex-row gap-xs"> ${a.J({appearance:"bordered",children:"Comment",leadingIcon:e.aD({size:e.I.Small}),selected:this.value===y.Comment,attributes:{type:"button",onclick:()=>{this.value=y.Comment,this.requestUpdate()}}})} ${this.isModmailAllowed?a.J({appearance:"bordered",children:"Mod Mail",leadingIcon:e.aG({size:e.I.Small}),selected:this.value===y.Modmail,attributes:{type:"button",onclick:()=>{this.value=y.Modmail,this.requestUpdate()}}}):e.A} <dont-notify-tooltip> ${a.J({appearance:"bordered",children:"Don't Notify",leadingIcon:e.bz({size:e.I.Small}),selected:this.value===y.DontNotify,attributes:{type:"button",onclick:()=>{this.value=y.DontNotify,this.requestUpdate()}}})} <dont-notify-tooltip-content ?is-ai-mod-enabled-for-subreddit="${this.isAIModEnabledForSubreddit}" slot="content"></dont-notify-tooltip-content> </dont-notify-tooltip> </div> ${this.renderValidationState()} `;}};var M;e._([e.n({type:Boolean,attribute:"is-mod-mail-allowed"})],z.prototype,"isModmailAllowed",void 0),e._([e.n({type:Boolean,attribute:"is-ai-mod-enabled-for-subreddit"})],z.prototype,"isAIModEnabledForSubreddit",void 0),z=e._([e.c("removal-reason-notification-method")],z),function(e){e.User="User",e.Mod="Mod"}(M||(M={}));let L=class extends b{static get styles(){return[a.t,e.i`:host{display:flex;flex-direction:column;gap:var(--spacer-xs)}`]}connectedCallback(){super.connectedCallback(),this.value=M.Mod}getValueMissingValidationMessage(){return "Please select the notification sender.";}render(){return e.x` <label class="text-16 text-neutral-content-strong"> ${this._internals.input} ${"Send message as"} </label> <div class="flex flex-row gap-xs"> ${a.J({appearance:"bordered",children:"Mod Team",leadingIcon:e.x`<slot name="mod-icon"></slot>`,selected:this.value===M.Mod&&!this.disabled,attributes:{type:"button",disabled:this.disabled,onclick:()=>{this.value=M.Mod,this.requestUpdate()}}})} ${a.J({appearance:"bordered",children:this.user,leadingIcon:e.x`<slot name="user-icon"></slot>`,selected:this.value===M.User&&!this.disabled,attributes:{type:"button",disabled:this.disabled,onclick:()=>{this.value=M.User,this.requestUpdate()}}})} </div> ${this.renderValidationState()} `;}};e._([e.n()],L.prototype,"user",void 0),L=e._([e.c("removal-reason-notification-sender")],L);class O extends CustomEvent{constructor(e){super(O.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}O.eventName="mod-removal-reason-added";class D extends CustomEvent{constructor(e){super(D.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}D.eventName="removal-reason-form-element-clicked";let C=class extends n.F{constructor(){super(),this._eventController=new a.E(this),this.handleFormElementClicked=e=>{e.target?.name&&this.dispatchEvent(new D({formElement:e.target.name}))},this.handleRemovalReasonInputChanged=e=>{if(e.target instanceof z){const a=e.target.value!==y.DontNotify;this.toggleNotificationSender(a),this.toggleMessageInput(a)}e.target instanceof T&&"removal-reason"===e.target.name&&this.toggleDefaultPolicyInput("default-removal-reason"===e.target.value)},this.convertFormDataToGql=e=>{const a=e.get("notification-method"),t=e.get("notification-sender"),i={reasonId:this.getRemovalReasonId(e),type:this.parseRemovalReasonMessageType(a,t),message:a===y.DontNotify?null:e.get("message"),isLockComment:e.has("lock")},n=e.get("modNote")||void 0,o={itemId:e.get("thing")?.toString()||"",removalReason:i,modNote:n};return this.lastSubmittedData=o,JSON.stringify({...o,csrf_token:e.get("csrf_token")})},this.encoders={...this.encoders,"application/json":this.convertFormDataToGql}}connectedCallback(){super.connectedCallback(),this._eventController.define(g,this.handleRemovalReasonInputChanged),this._eventController.define("click",this.handleFormElementClicked)}toggleNotificationSender(e){const a=this.elements["notification-sender"];a&&(e?a.removeAttribute("disabled"):a.setAttribute("disabled",""))}toggleField(e,a){e&&(a?(e.classList.remove("hidden"),e.setAttribute("required","")):(e.classList.add("hidden"),e.removeAttribute("required")))}toggleMessageInput(e){const a=this.elements.message;a&&this.toggleField(a,e)}toggleDefaultPolicyInput(e){const a=this.elements["default-removal-reason"];a&&this.toggleField(a,e)}showError(){const e={level:a.I.error,message:"Something went wrong",cause:a.aU.QueryBadResponse};this.dispatchEvent(a.c("faceplate-alert",e))}async handleResponse(e){if(!e.ok)return this.dispatchEvent(a.c(_.eventName)),this.showError();try{const t=await e.text(),i={level:a.I.success,message:"Removal reason added"},n=this.lastSubmittedData?.itemId||"";if(l.h(n)){const e={postId:n,action:r.a.addRemovalReason,value:!0};a.p(a.T.PostUpdated,e)}else{const e={commentId:n,action:s.C.addRemovalReason,value:!0};a.p(a.T.CommentUpdated,e)}if(t){const e={parentThingId:n,body:t};a.p(a.T.CommentCreated,e)}this.dispatchEvent(a.c(_.eventName)),this.dispatchEvent(a.c("faceplate-alert",i)),this.lastSubmittedData&&this.dispatchEvent(new O(this.lastSubmittedData))}catch{this.showError()}}parseRemovalReasonMessageType(e,t){return e===y.Comment?t===M.Mod?a.f7.CommentAsSubreddit:a.f7.CommentAsMod:e===y.Modmail?t===M.Mod?a.f7.MessageAsSubreddit:a.f7.MessageAsMod:null}getRemovalReasonId(e){const a=e.get("removal-reason");return"default-removal-reason"===a?e.get("default-removal-reason"):a}};C=e._([e.c("removal-reason-form")],C),o.r(C);const P={"removal-reason":"subreddit_removal_reason","default-removal-reason":"default_removal_reason",message:"message_to_user","notification-method":"notification_method","notification-sender":"notification_sender",modNote:"mod_note"};class A extends CustomEvent{constructor(e){super(A.eventName,{detail:e,bubbles:!0,composed:!0})}}A.eventName="mod-add-removal-reason-show-modal";class _ extends CustomEvent{constructor(){super(_.eventName)}}_.eventName="mod-add-removal-reason-toggle-loading";let j=class extends e.s{constructor(){super(...arguments),this.pubsub=new a.f(this),this.getInputValue=e=>this.removalReasonForm?.querySelector(`input[name="${e}"]`)?.value,this.buildAndTrackEvent=e=>{const t={action:"click",...e,authorId:this.getInputValue("authorId"),subredditId:this.getInputValue("subredditId"),subredditName:this.subredditName,thingId:this.thingId};a.a(this,i.r(t))},this.firstUpdated=()=>{this.isSmartEscalationsCommunityRulesEnabled&&this.updateComplete.then((()=>{this.primaryButton?.addEventListener("click",(()=>{this.removalReasonForm?.isValid&&(this.toggleButtonLoadingIndicator(),this.initSmartEscalations())}))}))},this.handleAddRemovalReasonEvent=({detail:e})=>{""!==e?this.show(e):this.thingId=void 0},this.handleFormElementClicked=e=>{const a={type:P[e.detail.formElement]||e.detail.formElement},t=this.removalReasonForm?.elements[e.detail.formElement]?.value||this.getInputValue(e.detail.formElement);if("lock"===e.detail.formElement&&(a.isLocked="on"===t),"notification-method"===e.detail.formElement){if(!t)return;a.notificationMethod=t}if("notification-sender"===e.detail.formElement){if(!t)return;a.sendAs=t}this.buildAndTrackEvent(a)},this.handleSelectRemovalReason=async e=>{const a=this.removalReasonInput?.removalReasonSuggestionsContext;e.detail.trackEvent&&this.buildAndTrackEvent({type:e.detail.isSitewide?"default_removal_reason":"subreddit_removal_reason",reason:e.detail.id,noun:"removal_reason_select",subredditId:a?.eventContext?.subredditId,postId:a?.eventContext?.postId,commentId:a?.eventContext?.commentId});const t=this.removalReasonForm,i=this.shadowRoot?.querySelector("faceplate-textarea-input");i&&e.detail.message&&(i.value=await this.renderRemovalReasonMessage(e.detail.id,e.detail.message),await i.updateComplete,i.syncInputValidity(),t?.notifyObservers(i))},this.renderRemovalReasonMessage=async(e,a)=>{try{return await this.renderRemovalReasonAsSavedResponseTemplate(e)}catch{return a}},this.renderSavedResponseTemplateBySubredditId=t.bS,this.renderRemovalReasonAsSavedResponseTemplate=async e=>{const a=await this.renderSavedResponseTemplateBySubredditId({responseId:e,subredditId:this.getInputValue("subredditId")||"",contentId:this.thingId});return a?a.templateValidation?.ok?(this.removalReasonInput?.setInvalidMacro(!1),a.response.markdown):(this.removalReasonInput?.setInvalidMacro(!0),""):""},this.handleAddedRemovalReason=e=>{let t=function(e){let t;t=e.type===a.f7.CommentAsMod||e.type===a.f7.CommentAsSubreddit?"comment":e.type===a.f7.MessageAsMod||e.type===a.f7.MessageAsSubreddit?"modmail":"no message";const i=e.type===a.f7.CommentAsSubreddit||e.type===a.f7.MessageAsSubreddit?"subreddit":"self";return{is_locked:e.isLockComment,notify:t,send_as:i}}(e.detail.removalReason);const n=this.removalReasonInput?.removalReasonSuggestionsContext?.predictedRemovalSavedResponses?.map((e=>e.id));n&&(t={...t,suggestion_list:n}),a.a(this,i.a(t,this.removalReasonInput?.value??void 0,this.removalReasonInput?.removalReasonSuggestionsContext?.eventContext)),this.isSmartEscalationsCommunityRulesEnabled&&!this.isExpandSuggestedActionsEnabled?(this.buildAndTrackEvent({type:"submit_button",reason:"default-removal-reason"===this.removalReasonInput?.value?this.defaultRemovalReasonInput?.value??void 0:this.removalReasonInput?.value??void 0,notificationMethod:this.removalReasonForm?.elements["notification-method"]?.value,sendAs:this.removalReasonForm?.elements["notification-sender"]?.value,isLocked:"on"===this.getInputValue("lock"),modNote:this.getInputValue("modNote"),message:this.getInputValue("message")}),this.pubsub.publish(a.T.RemovalReasonStatus,{status:p.R.SUCCESS})):this.close()},this.handleCancel=e=>{e.stopImmediatePropagation(),this.buildAndTrackEvent({type:"close_button"}),a.a(this,i.b()),this.close()},this.toggleButtonLoadingIndicator=()=>{this.primaryButton?.querySelector("faceplate-progress")?.classList.toggle("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.toggle("opacity-0")},this.showHideSubmitButton=()=>{this.removalReasonInput?this.primaryButton?.classList.remove("hidden"):this.primaryButton?.classList.add("hidden")},this.close=()=>{this.modal?.open&&(this.modal?.close(),document.body.style.overflow="auto",document.body.style.pointerEvents="auto")},this.initSmartEscalations=()=>{const e=this.getInputValue("authorId"),t=this.getInputValue("subredditId"),i=e&&t&&this.thingId;i&&this.pubsub.publish(a.T.SmartEscalationsInit,{thingId:this.thingId,authorId:e,subredditId:t,removalReasonId:(this.defaultRemovalReasonInput?.value||this.removalReasonInput?.value)??"",removalReasonDisplayText:(this.defaultRemovalReasonInput?.displayText||this.removalReasonInput?.displayText)??""}),!i&&this.close()}}get removalReasonInput(){return this.shadowRoot?.querySelector('[name="removal-reason"]')}get defaultRemovalReasonInput(){return this.shadowRoot?.querySelector('[name="default-removal-reason"]')}get removalReasonForm(){return this.shadowRoot?.querySelector("removal-reason-form")}get primaryButton(){return this.shadowRoot?.querySelector('faceplate-modal [slot=primaryButton] button[type="submit"]')}get selectedSuggestionValue(){const e=this.removalReasonInput?.shadowRoot?.querySelector("removal-reason-suggestions"),a=e?.getSelectedChip();return a?.dataset.removalReasonId}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(a.T.AddRemovalReasonClose,this.close,!1),this.addEventListener(f.eventName,this.handleSelectRemovalReason),this.addEventListener(O.eventName,this.handleAddedRemovalReason),this.addEventListener(_.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(D.eventName,this.handleFormElementClicked),window.addEventListener(A.eventName,this.handleAddRemovalReasonEvent)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener(A.eventName,this.handleAddRemovalReasonEvent),this.removeEventListener(f.eventName,this.handleSelectRemovalReason),this.removeEventListener(O.eventName,this.handleAddedRemovalReason),this.removeEventListener(_.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(D.eventName,this.handleFormElementClicked)}async show(e){e&&(this.thingId=e,await this.updateComplete),this.modal?.showModal(),await(this.partial?.load()),this.buildAndTrackEvent({action:"view"}),this.primaryButton?.querySelector("faceplate-progress")?.classList.add("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.remove("opacity-0"),this.showHideSubmitButton()}render(){return e.x` <removal-reason-form class="mb-0" enctype="application/json" method="POST" action="/svc/shreddit/mod/removal-reason"> <faceplate-modal class="max-w-[540px] w-[90v w] z-30"> <div slot="closeButton"> ${a.J({appearance:"secondary",leadingIcon:e.m({size:e.I.Small}),size:a.a2.Small,attributes:{type:"button",onclick:this.handleCancel}})} </div> <input type="hidden" name="thing" value="${this.thingId}"> ${t.L(this.thingId,e.x` <faceplate-partial class="w-100" src="/svc/shreddit/removal-reason-form/${this.thingId}" loading="${a.h.Programmatic}"> <div class="w-100 h-4xl flex items-center justify-center"> <faceplate-progress value="20" class="animate-spin"></faceplate-progress> </div> </faceplate-partial> `)} <div slot="primaryButton"> ${a.J({children:e.x`<faceplate-progress value="20" class="animate-spin loading-icon hidden absolute left-0 right-0 m-auto w-[16px]" style="--loader-size:1rem"></faceplate-progress> <span class="submit-button-content"> ${"Submit"}</span>`,appearance:"primary",attributes:{type:"submit",className:"w-100 relative"}})} </div> <div slot="secondaryButton"> ${a.J({children:"Cancel",appearance:"plain",attributes:{className:"w-100",type:"button",onclick:this.handleCancel}})} </div> </faceplate-modal> </removal-reason-form> `;}};return j.styles=[a.t],e._([e.n({type:Boolean,attribute:"is-smart-escalations-community-rules-enabled"})],j.prototype,"isSmartEscalationsCommunityRulesEnabled",void 0),e._([e.n({type:Boolean,attribute:"is-expand-suggested-actions-enabled"})],j.prototype,"isExpandSuggestedActionsEnabled",void 0),e._([e.n({type:String})],j.prototype,"thingId",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],j.prototype,"subredditName",void 0),e._([e.D("faceplate-modal")],j.prototype,"modal",void 0),e._([e.D("faceplate-partial")],j.prototype,"partial",void 0),j=e._([e.c("add-removal-reason-modal")],j),{A}}));